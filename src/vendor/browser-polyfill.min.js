(function(){if(typeof browser!=='undefined')return;var chromeApi=typeof chrome!=='undefined'?chrome:null;if(!chromeApi)return;function lastError(){return chromeApi.runtime&&chromeApi.runtime.lastError?chromeApi.runtime.lastError:null;}var browserShim={};browserShim.runtime={};browserShim.storage={};if(chromeApi.runtime){browserShim.runtime.sendMessage=function(){var args=Array.prototype.slice.call(arguments);return new Promise(function(resolve,reject){try{args.push(function(res){var err=lastError();if(err)reject(err);else resolve(res);});chromeApi.runtime.sendMessage.apply(chromeApi.runtime,args);}catch(e){reject(e);}});} ;browserShim.runtime.onMessage=chromeApi.runtime.onMessage;browserShim.runtime.getURL=function(){return chromeApi.runtime.getURL.apply(chromeApi.runtime,arguments);};}if(chromeApi.storage&&chromeApi.storage.local){browserShim.storage.local={get:function(keys){return new Promise(function(resolve,reject){try{chromeApi.storage.local.get(keys,function(res){var err=lastError();if(err)reject(err);else resolve(res);});}catch(e){reject(e);}});},set:function(obj){return new Promise(function(resolve,reject){try{chromeApi.storage.local.set(obj,function(){var err=lastError();if(err)reject(err);else resolve();});}catch(e){reject(e);}});},remove:function(keys){return new Promise(function(resolve,reject){try{chromeApi.storage.local.remove(keys,function(){var err=lastError();if(err)reject(err);else resolve();});}catch(e){reject(e);}});}};}this.browser=browserShim;})();